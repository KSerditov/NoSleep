- [Обзор](#обзор-nosleep)
- [Диагностика](#диагностика)
- [Использование активности для PIX Robotics](#использование-активности-для-pix-robotics)

# Обзор NoSleep
NoSleep предоставляет код и компоненты .NET, предназначенные для предотвращения перехода системы Windows в режим сна или энергосбережения. Он разработан для интеграции с инструментами роботизированной автоматизации процессов (RPA), хотя его можно использовать и как автономное решение.

# Диагностика
Прежде чем интегрировать код NoSleep в свое решение, важно убедиться, что ваша система действительно испытывает проблемы, связанные с режимами сна или энергосбережения. Для этого вы можете использовать предварительно скомпилированные исполняемые файлы из папки [Executables](./NoSleep.Releases/Executables/). Следуйте этим шагам:

1. Скопируйте исполняемый файл, соответствующий вашему установленному .NET Runtime.
2. Запустите его из командной строки с помощью этой команды:
```
NoSleep.Executable.exe --listen-only
```
The output should look something like this:
```
7/14/2023 11:04:07 PM +03:00: Initiating awaker...
7/14/2023 11:04:07 PM +03:00: System events listener has been started
7/14/2023 11:04:07 PM +03:00: Awaker is not started per --listen-only argument
Press ENTER to shutdown.
```
3. Позвольте вашей машине работать в течение необходимого времени для проявления проблемы. Это должно быть время, необходимое для того, чтобы машина перешла в режим сна, заблокировалась или перешла в режим энергосбережения.
4. После истечения этого времени разблокируйте машину и изучите вывод консоли. Вы должны видеть сообщения о переходе машины в режим энергосбережения или о блокировке экрана.
5. Нажмите ENTER, чтобы остановить выполнение.
6. Теперь запустите приложение без `--listen-only`:
```
NoSleep.Executable.exe --listen-only
```
Вывод должен быть похожим на это:
```
7/14/2023 11:08:22 PM +03:00: Initiating awaker...
7/14/2023 11:08:22 PM +03:00: System events listener has been started
7/14/2023 11:08:22 PM +03:00: Awaker has been started
Press ENTER to shutdown.
```
7. Позвольте машине работать в течение требуемого времени. Если проблема не повторяется, есть смысл интегрировать NoSleep в ваше решение.

# Использование активности для PIX Robotics
В репозитории находится предварительно скомпилированная активность для PIX Robotics, которую можно использовать напрямую.
1. Скопируйте содержимое [PIX Libraries](./NoSleep.Releases/Libs.PIX/) для целевой архитектуры в папку установки PIX RPA.
2. Перезапустите PIX Studio и вы найдете новые активности:
   
![image](https://github.com/KSerditov/NoSleep/assets/3009597/97bc3501-38e5-4f09-9abe-86fb943de031)

3. В начале выполнения используйте NoSleep Launcher, а в конце вызовите NoSleep Stopper (желательно в последнем блоке 'Finally'):
   
![image](https://github.com/KSerditov/NoSleep/assets/3009597/03461fa8-c6b0-4c10-b17d-4ab6f34ab278)

4. Вы также можете использовать [PIX-DemoProject](./PIX-DemoProject) ля тестирования его работы. Не забудьте отрегулировать количество итераций и продолжительность блока 'Ожидание', чтобы покрыть время, необходимое для воспроизведения проблемы.
